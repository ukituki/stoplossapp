{
    "contents" : "library(shiny)\n# library(PerformanceAnalytics)\n\nlibrary(zoo)\nlibrary(tseries)\nlibrary(quantmod)\n\ncalculateR <- function(totalPortfolio, riskPerc){\n        return(riskPerc * totalPortfolio)\n}\n\ncalculateSharesToBuy <- function(closePrice, stopPrice, R){\n        return(R/(closePrice-stopPrice))\n}\n\n# R = 0.02\n# totalPortfolio = 50000\n# R*totalPortfolio\n# closePrice = 593\n# stopPrice = 553\n# riskPerShare = closePrice - stopPrice\n# riskPerShare\n# (R*totalPortfolio)/riskPerShare\n\nshinyServer(\n        function(input, output) {\n                output$priceChart <- renderPlot({\n                        stock.prices <- get.hist.quote(instrument=input$stock, quote=c(\"Cl\"))\n                        closePrice <<- tail(stock.prices, 1)\n                        stopPrice <<- {closePrice} *(1-{input$stopPerc})\n                        plot(stock.prices)\n                        abline(h=stopPrice, col = \"red\")\n                        text(x=index(stock.prices)[length(stock.prices)*0.8],\n                             y= {stopPrice}*0.98, \n                             label = paste(\"Stop Loss:\", round({stopPrice},2)), \n                             col=\"red\")})\n                output$totalPortfolio <- renderPrint({input$totalPortfolio})\n                output$R <- renderText({input$totalPortfolio} * {input$riskPerc})\n                output$stock <- renderText({input$stock})\n                output$stopPrice <- renderText({round(closePrice *(1-input$stopPerc),2)})\n                output$sharesToBuy <- renderText({round({input$totalPortfolio} * {input$riskPerc}\n                                                        /({closePrice-stopPrice}),0)})\n                output$stock <- renderText({input$stock})\n                output$stock <- renderText({input$stock})\n        }\n)",
    "created" : 1414363774214.000,
    "dirty" : false,
    "encoding" : "UTF-8",
    "folds" : "",
    "hash" : "806488015",
    "id" : "32E0BA01",
    "lastKnownWriteTime" : 1406550277,
    "path" : "~/Documents/edu/datasciencecoursera/9 Data Driven Products/server.R",
    "project_path" : "server.R",
    "properties" : {
    },
    "source_on_save" : false,
    "type" : "r_source"
}